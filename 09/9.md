
# k8s cka 题目知识点类型


## 1 RABC 权限模型

(RBAC)[https://kubernetes.io/zh-cn/docs/reference/access-authn-authz/rbac/]


## 2 节点维护

(cordon)[https://kubernetes.io/zh-cn/docs/reference/kubectl/generated/kubectl_cordon/]


(drain)[https://kubernetes.io/zh-cn/docs/reference/kubectl/generated/kubectl_drain/]



## 3 k8s版本升级

(ugrade)[https://kubernetes.io/zh-cn/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade/]



## 4， etcd备份与还原


(etcd)[https://kubernetes.io/zh-cn/docs/tasks/administer-cluster/configure-upgrade-etcd/]


```

etcdctl \
  --endpoints=https://127.0.0.1:2379 \
  --cacert=/etc/kubernetes/pki/etcd/ca.crt \
  --cert=/etc/kubernetes/pki/apiserver-etcd-client.crt \
  --key=/etc/kubernetes/pki/apiserver-etcd-client.key \
  member list


1d5a35a426b9afa3, started, kind-control-plane, https://10.89.0.15:2380, https://10.89.0.2:2379, false

alias etcdctl="etcdctl  --endpoints=https://127.0.0.1:2379  --cacert=/etc/kubernetes/pki/etcd/ca.crt  --cert=/etc/kubernetes/pki/apiserver-etcd-client.crt  --key=/etc/kubernetes/pki/apiserver-etcd-client.key" 




root@kind-control-plane:/# etcdctl member list
1d5a35a426b9afa3, started, kind-control-plane, https://10.89.0.15:2380, https://10.89.0.2:2379, false





root@kind-control-plane:~/etcdbak# etcdctl snapshot save snapshot.db
{"level":"info","ts":1761049143.502104,"caller":"snapshot/v3_snapshot.go:119","msg":"created temporary db file","path":"snapshot.db.part"}
{"level":"info","ts":"2025-10-21T12:19:03.509Z","caller":"clientv3/maintenance.go:200","msg":"opened snapshot stream; downloading"}
{"level":"info","ts":1761049143.5091052,"caller":"snapshot/v3_snapshot.go:127","msg":"fetching snapshot","endpoint":"https://127.0.0.1:2379"}
{"level":"info","ts":"2025-10-21T12:19:03.535Z","caller":"clientv3/maintenance.go:208","msg":"completed snapshot read; closing"}
{"level":"info","ts":1761049143.552091,"caller":"snapshot/v3_snapshot.go:142","msg":"fetched snapshot","endpoint":"https://127.0.0.1:2379","size":"3.9 MB","took":0.049471783}
{"level":"info","ts":1761049143.5521848,"caller":"snapshot/v3_snapshot.go:152","msg":"saved","path":"snapshot.db"}
Snapshot saved at snapshot.db
root@kind-control-plane:~/etcdbak# ls
snapshot.db




root@kind-control-plane:~/etcdbak# etcdctl --data-dir /var/lib/etcd snapshot restore snapshot.db
Error: data-dir "/var/lib/etcd" exists


 etcdctl --data-dir /var/lib/etcd2 snapshot restore snapshot.db
{"level":"info","ts":1761049678.549787,"caller":"snapshot/v3_snapshot.go:296","msg":"restoring snapshot","path":"snapshot.db","wal-dir":"/var/lib/etcd2/member/wal","data-dir":"/var/lib/etcd2","snap-dir":"/var/lib/etcd2/member/snap"}
{"level":"info","ts":1761049678.577035,"caller":"mvcc/kvstore.go:388","msg":"restored last compact revision","meta-bucket-name":"meta","meta-bucket-name-key":"finishedCompactRev","restored-compact-revision":34319}
{"level":"info","ts":1761049678.5941927,"caller":"membership/cluster.go:392","msg":"added member","cluster-id":"cdf818194e3a8c32","local-member-id":"0","added-peer-id":"8e9e05c52164694d","added-peer-peer-urls":["http://localhost:2380"]}
{"level":"info","ts":1761049678.6269171,"caller":"snapshot/v3_snapshot.go:309","msg":"restored snapshot","path":"snapshot.db","wal-dir":"/var/lib/etcd2/member/wal","data-dir":"/var/lib/etcd2","snap-dir":"/var/lib/etcd2/member/snap"}

```



## 5 NetWorkpolicy 网络模型




(NetWorkpolicy)[https://kubernetes.io/zh-cn/docs/concepts/services-networking/network-policies/]


## 6  Service


(Service)[https://kubernetes.io/zh-cn/docs/concepts/services-networking/service/]


## 7 Ingress 七层代理模型



(Ingress)[https://kubernetes.io/zh-cn/docs/concepts/services-networking/ingress/]

## 8 Deployment 管理pod扩缩容


```
k edit deployment nginx-deployment
```

OR

(scale)[https://kubernetes.io/zh-cn/docs/reference/kubectl/generated/kubectl_scale/]



## 9 pod指定节点部署


(分配pod到节点)[https://kubernetes.io/zh-cn/docs/tasks/configure-pod-container/assign-pods-nodes/]



## 10 检查Node节点的健康状态


```

 k get nodes |grep -i ready


 k describe node |grep Taint |grep NoSchedule

```





## 11 pod封装多个容器




## 持久好存储卷PersistentVolume


(PV)[https://kubernetes.io/zh-cn/docs/tasks/configure-pod-container/configure-persistent-volume-storage/]



## 13 PersistentVolumeClaim 动态申请存储卷



```
k edit pvc pv-volume

# 注意注解
metadata:
  annotations:
    kubernetes.io/change-cause: "resize"
# 具备上面的注释才可以调整大小

# 或者使用patch命令

k patch pvc pv-volume -p '{"spec":{"resources":{"requests":"{"storage":"79Mi"}"}}}' --record


```


## 14 收集Pod日志

(video)[https://www.bilibili.com/video/BV1Kz421U7i2?spm_id_from=333.788.videopod.episodes&vd_source=9d82f6f59d24c8b6a32623a779e09334&p=37]


```
kubectl logs foobar |grep unable-access-website > /opt/KUTR00101/foobar

```



## 15 Sidecar代理


(log)[https://kubernetes.io/zh-cn/docs/concepts/cluster-administration/logging/]


## 16 监控pod度量指标




## 17 集群故障排查


    (主节点损害情况)[https://kubernetes.io/zh-cn/docs/tasks/configure-pod-container/static-pod/]

```
root@kind-worker:/# cat <<EOF >/etc/kubernetes/manifests/static-web.yaml
apiVersion: v1
kind: Pod
metadata:
  name: static-web
  labels:
    role: myrole
spec:
  containers:
    - name: web
      image: nginx
      ports:
        - name: web
          containerPort: 80
          protocol: TCP
EOF



# 执行过后查看并没有效果

root@kind-worker:/# ls -al /etc/kubernetes/manifests/
total 4
drwxr-xr-x. 1 root root  29 Oct 23 12:47 .
drwxr-xr-x. 1 root root  54 Oct 10 14:22 ..
-rw-r--r--. 1 root root 221 Oct 23 12:47 static-web.yaml


root@kind-worker:/# crictl ps -a 
CONTAINER           IMAGE               CREATED             STATE               NAME                     ATTEMPT             POD ID              POD                                       NAMESPACE
9629b3b1fecdc       e612b97116b41       36 minutes ago      Running             web                      0                   96597ca306a59       static-web-kind-worker                    default
237be2c5c8aaa       f72407be9e08c       About an hour ago   Running             coredns                  3                   a3e52896d6aeb       coredns-674b8bbfcf-72xg6                  kube-system
1082090c4f9e8       f72407be9e08c       About an hour ago   Running             coredns                  4                   4a82fe4368a25       coredns-674b8bbfcf-9dds5                  kube-system
67ce322742330       653e2348b2d4a       About an hour ago   Running             local-path-provisioner   5                   47f742448bcbc       local-path-provisioner-7dc846544d-6kzkx   local-path-storage
38dcbe7568278       3e58848989f55       About an hour ago   Running             kube-proxy               5                   f08f9bdfeb17d       kube-proxy-6ktkk                          kube-system
340a4bc02b5ce       b1a8c6f707935       About an hour ago   Running             kindnet-cni              5                   f30153db0494c       kindnet-xvz5g                             kube-system
effbec2bf830b       e612b97116b41       About an hour ago   Running             nginx                    5                   76c2b7c268b00       nginx-db7574cdc-9ljcv                     default
e93fe4f24339d       653e2348b2d4a       2 days ago          Exited              local-path-provisioner   4                   088c7f5fba8d2       local-path-provisioner-7dc846544d-6kzkx   local-path-storage
66c93c2d8d8a9       e612b97116b41       2 days ago          Exited              nginx                    4                   892660b68e947       nginx-db7574cdc-9ljcv                     default
797b6bea9a7a4       f72407be9e08c       2 days ago          Exited              coredns                  3                   a058267d8e420       coredns-674b8bbfcf-9dds5                  kube-system
3f7baf8aa5455       f72407be9e08c       2 days ago          Exited              coredns                  2                   c20845a005bed       coredns-674b8bbfcf-72xg6                  kube-system
3471a2f36cc40       b1a8c6f707935       2 days ago          Exited              kindnet-cni              4                   2194ed569bc98       kindnet-xvz5g                             kube-system
3091ed3889125       3e58848989f55       2 days ago          Exited              kube-proxy               4                   5d13e0cfb46ba       kube-proxy-6ktkk                          kube-system
root@kind-worker:/# 


```